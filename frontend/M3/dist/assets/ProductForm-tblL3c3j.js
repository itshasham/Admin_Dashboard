import{a as Le,r as m,j as e,A as v}from"./index-CPlrO2ek.js";/* empty css                */import{p as Ue}from"./api-error-B8TEswhR.js";const H={img:"",title:"",unit:"",parent:"",children:"",price:"",discount:0,quantity:0,brand:{name:"",id:""},category:{name:"",id:""},status:"in-stock",productType:"",description:"",imageURLs:[]},Pe=o=>!o||typeof o!="object"?[]:Array.isArray(o.images)?o.images:Array.isArray(o.data)?o.data:o.data&&Array.isArray(o.data.images)?o.data.images:[],pe=o=>{const p=typeof o=="string"?o:(o==null?void 0:o.img)||(o==null?void 0:o.url)||"",t=String(p||"").trim();return t?{...typeof o=="object"&&o?o:{},img:t,color:typeof o=="object"&&(o==null?void 0:o.color)||{name:"default",value:"#000000"}}:null},w=o=>{const p=Array.isArray(o)?o:[],t=new Set,u=[];return p.forEach(R=>{const j=pe(R);if(!(j!=null&&j.img))return;const S=j.img.toLowerCase();t.has(S)||(t.add(S),u.push(j))}),u},Me=()=>{const{id:o}=Le(),p=!!o,[t,u]=m.useState(H),[R,j]=m.useState(""),[S,K]=m.useState(""),[Q,T]=m.useState(!1),[V,C]=m.useState(""),[Z,$]=m.useState([]),[I,G]=m.useState([]),[D,B]=m.useState(!1),[A,W]=m.useState([]),[E,q]=m.useState(!1),[O,X]=m.useState(!1),[F,ee]=m.useState("additional"),[_,se]=m.useState(!1),[ae,k]=m.useState(""),[J,re]=m.useState(""),[te,ie]=m.useState([]),[b,z]=m.useState({}),L=()=>{try{const s=localStorage.getItem("adminToken");return s?{Authorization:`Bearer ${s}`}:{}}catch{return{}}},ne=s=>{if(!s)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(s))return s;const a=new Date(s);if(!isNaN(a.getTime())){const n=a.getFullYear(),r=String(a.getMonth()+1).padStart(2,"0"),c=String(a.getDate()).padStart(2,"0");return`${n}-${r}-${c}`}return typeof s=="string"&&s.length>=10?s.slice(0,10):""},ce=s=>{if(s&&/^\d{4}-\d{2}-\d{2}$/.test(s))try{const a=new Date(`${s}T00:00:00.000Z`);return isNaN(a.getTime())?void 0:a.toISOString()}catch{return}},le=s=>{var a;return typeof s=="string"?((a=s.match(/\d+/g))==null?void 0:a.join(""))||"":s},fe=s=>{const a=Array.isArray(s)?s.map(n=>String(n||"").trim()).filter(Boolean):[];a.length&&u(n=>{const r=w(n.imageURLs),c=new Set(r.map(i=>i.img.toLowerCase())),l=[...r];return a.forEach(i=>{const d=i.toLowerCase();if(c.has(d))return;c.add(d);const g=pe(i);g&&l.push(g)}),{...n,imageURLs:l}})},je=async()=>{var s;B(!0);try{console.log("Fetching brands from:",`${v}/brand/all`);const a=await fetch(`${v}/brand/all`,{headers:{...L()},cache:"no-store"});if(console.log("Brands API Status:",a.status,a.statusText),a.status===304){console.log("304 - Not modified, using cached data"),B(!1);return}const r=((s=a.headers.get("content-type"))==null?void 0:s.includes("application/json"))?await a.json().catch(()=>null):null;if(console.log("Brands API Response:",r),console.log("Response headers:",Object.fromEntries(a.headers.entries())),!a.ok)throw console.error("API Error:",a.status,r==null?void 0:r.message),new Error((r==null?void 0:r.message)||"Failed to load brands");let c=[];if(Array.isArray(r))c=r,console.log("Data is direct array");else if(r&&typeof r=="object"){const l=[r.data,r.brands,r.items,r.results,r.list,r.records];for(const i of l)if(Array.isArray(i)){c=i,console.log("Found brands in:",Object.keys(r).find(d=>r[d]===i));break}if(c.length===0){const i=(d,g=0)=>{if(g>3||!d||typeof d!="object")return null;for(const f in d){if(Array.isArray(d[f]))return d[f];const x=i(d[f],g+1);if(x)return x}return null};c=i(r)||[],c.length>0&&console.log("Found nested array")}}console.log("Final brands array:",c),console.log("Number of brands:",c.length),c.length>0&&console.log("First brand example:",c[0]),G(Array.isArray(c)?c:[])}catch(a){console.error("Failed to load brands:",a),G([])}finally{B(!1)}},xe=async()=>{var s;q(!0);try{console.log("Fetching categories from:",`${v}/category/all`);const a=await fetch(`${v}/category/all`,{headers:{...L()},cache:"no-store"});if(console.log("Categories API Status:",a.status,a.statusText),a.status===304){console.log("304 - Not modified, using cached data"),q(!1);return}const r=((s=a.headers.get("content-type"))==null?void 0:s.includes("application/json"))?await a.json().catch(()=>null):null;if(console.log("Categories API Response:",r),!a.ok)throw console.error("Categories API Error:",a.status,r==null?void 0:r.message),new Error((r==null?void 0:r.message)||"Failed to load categories");const l=(i=>i?Array.isArray(i)?i:Array.isArray(i.result)?i.result:Array.isArray(i.data)?i.data:i.data&&Array.isArray(i.data.result)?i.data.result:i.data&&Array.isArray(i.data.data)?i.data.data:[]:[])(r);console.log("Final categories array:",l),console.log("Number of categories:",l.length),l.length>0&&console.log("First category example:",l[0]),W(Array.isArray(l)?l:[])}catch(a){console.error("Failed to load categories:",a),W([])}finally{q(!1)}};m.useEffect(()=>{(async()=>{var a,n;if(p)try{const r=await fetch(`${v}/product/single-product/${o}`,{headers:{...L()}}),c=await r.json();if(!r.ok)throw new Error((c==null?void 0:c.message)||"Failed to load product");const l=(c==null?void 0:c.data)||(c==null?void 0:c.product)||c||H,i=le(l.unit||"");u({...H,...l,unit:i,imageURLs:w(l==null?void 0:l.imageURLs)});const d=ne((a=l==null?void 0:l.offerDate)==null?void 0:a.startDate)||"",g=ne((n=l==null?void 0:l.offerDate)==null?void 0:n.endDate)||"";j(d),K(g)}catch(r){C(r.message||"Failed to load product")}})(),je(),xe()},[o,p]);const Y=async(s=J)=>{se(!0),k("");try{const a=new URL(`${v}/cloudinary/images`);String(s||"").trim()&&a.searchParams.set("q",String(s).trim());const n=await fetch(a.toString(),{headers:{...L()},cache:"no-store"}),r=await n.json().catch(()=>({}));if(!n.ok)throw new Error((r==null?void 0:r.message)||(r==null?void 0:r.error)||"Failed to load image manager");const c=Pe(r).map((i,d)=>({id:(i==null?void 0:i._id)||(i==null?void 0:i.publicId)||(i==null?void 0:i.id)||`manager-image-${d}`,publicId:(i==null?void 0:i.publicId)||(i==null?void 0:i.id)||"",url:String((i==null?void 0:i.url)||(i==null?void 0:i.img)||"").trim()})).filter(i=>i.url),l=new Map;c.forEach(i=>{l.has(i.url)||l.set(i.url,i)}),ie(Array.from(l.values()))}catch(a){k(a.message||"Failed to load image manager"),ie([])}finally{se(!1)}};m.useEffect(()=>{O&&Y()},[O]);const h=s=>{const{name:a,value:n}=s.target;if(a==="unit"){u(r=>({...r,unit:le(n)}));return}u(r=>({...r,[a]:n}))},ve=s=>{const a=s.target.value,n=I.find(r=>(r._id||r.id||r.uuid)===a);if(console.log("Selected brand:",n),n){const r=n._id||n.id||n.uuid||"",c=n.name||n.brandName||n.title||"";u(l=>({...l,brand:{name:c,id:r}}))}else u(r=>({...r,brand:{name:"",id:""}}))},Ne=s=>{const a=s.target.value,n=A.find(r=>(r._id||r.id||r.uuid)===a);if(console.log("Selected category:",n),n){const r=n._id||n.id||n.uuid||"",c=n.parent||n.name||n.categoryName||n.title||"";u(l=>({...l,category:{name:c,id:r}}))}else u(r=>({...r,category:{name:"",id:""}}))},be=s=>{u(a=>({...a,imageURLs:w(a.imageURLs).filter((n,r)=>r!==s)}))},oe=(s="additional")=>{ee(s==="main"?"main":"additional"),z({}),k(""),X(!0)},M=()=>{X(!1),ee("additional"),z({}),k(""),re("")},ye=s=>{const a=String(s||"").trim();if(a){if(F==="main"){u(n=>({...n,img:a})),M();return}z(n=>({...n,[a]:!n[a]}))}},we=()=>{if(F==="main")return;const s=Object.keys(b).filter(a=>b[a]);if(!s.length){k("Select at least one image.");return}fe(s),M()},U=Object.keys(b).filter(s=>b[s]).length,P=F==="main",Se=()=>{var a,n,r,c,l,i,d,g,f,x,y;const s=[];return(a=t.title)!=null&&a.trim()||s.push("Title is required"),(!t.price||t.price<=0)&&s.push("Valid price is required"),(r=(n=t.brand)==null?void 0:n.name)!=null&&r.trim()||s.push("Brand name is required"),(l=(c=t.brand)==null?void 0:c.id)!=null&&l.trim()||s.push("Brand ID is required"),(d=(i=t.category)==null?void 0:i.name)!=null&&d.trim()||s.push("Category name is required"),(f=(g=t.category)==null?void 0:g.id)!=null&&f.trim()||s.push("Category ID is required"),(x=t.children)!=null&&x.trim()||s.push("Children field is required"),(y=t.productType)!=null&&y.trim()||s.push("Product type is required"),s},Ce=async s=>{var n,r,c,l,i,d,g,f,x;s.preventDefault(),T(!0),C(""),$([]);const a=Se();if(a.length>0){C("Please fix the highlighted product details before saving."),$(a),T(!1),window.scrollTo({top:0,behavior:"smooth"});return}try{const y=p?`${v}/product/edit-product/${o}`:`${v}/product/add`,Ie=p?"PATCH":"POST",de={img:t.img,title:t.title,unit:t.unit,parent:t.parent,children:t.children,price:t.price===""?void 0:Number(t.price),discount:t.discount===""?void 0:Number(t.discount),quantity:t.quantity===""?void 0:Number(t.quantity),brand:{name:((n=t.brand)==null?void 0:n.name)||"",id:((r=t.brand)==null?void 0:r.id)||""},category:{name:((c=t.category)==null?void 0:c.name)||"",id:((l=t.category)==null?void 0:l.id)||""},status:t.status,productType:t.productType,description:t.description,imageURLs:w(t.imageURLs)},me=ce(R),ue=ce(S);me&&ue&&(de.offerDate={startDate:me,endDate:ue});const Ae={...de,brand:{name:((i=t.brand)==null?void 0:i.name)||"",id:((d=t.brand)==null?void 0:d.id)||""},category:{name:((g=t.category)==null?void 0:g.name)||"",id:((f=t.category)==null?void 0:f.id)||""},children:t.children||"",imageURLs:w(t.imageURLs)},N=await fetch(y,{method:Ie,headers:{"Content-Type":"application/json",...L()},body:JSON.stringify(Ae)}),ge=((x=N.headers.get("content-type"))==null?void 0:x.includes("application/json"))?await N.json().catch(()=>({})):{};if(!N.ok){console.error("Product save error",{status:N.status,data:ge});const ke=N.status===401?"Your session has expired. Please log in again.":N.status===403?"You do not have permission to add or edit products.":`Save failed (${N.status}). Please review and try again.`,he=Ue(ge,ke);C(he.summary),$(he.issues),window.scrollTo({top:0,behavior:"smooth"});return}window.location.href="/admin/products"}catch(y){C(y.message||"Save failed"),$([]),window.scrollTo({top:0,behavior:"smooth"})}finally{T(!1)}};return e.jsxs("div",{className:"page-container",children:[e.jsxs("div",{className:"page-header fancy",children:[e.jsxs("div",{children:[e.jsx("h2",{children:p?"Edit Product":"New Product"}),e.jsx("p",{className:"muted",children:"Create product entries with confidence and clarity"})]}),e.jsx("button",{className:"btn secondary",type:"button",onClick:()=>window.location.href="/admin/dashboard",children:"â† Back"})]}),V&&e.jsxs("div",{className:"error-panel",role:"alert","aria-live":"polite",children:[e.jsx("p",{className:"error-panel-title",children:V}),Z.length>0&&e.jsx("ul",{className:"error-panel-list",children:Z.map((s,a)=>e.jsx("li",{children:s},`${s}-${a}`))})]}),e.jsxs("div",{className:"product-form-shell",children:[e.jsxs("div",{className:"product-side",children:[e.jsxs("div",{className:"card product-preview-card",children:[e.jsx("div",{className:"product-preview-media",children:t.img?e.jsx("img",{src:t.img,alt:"Product preview",onError:s=>{s.currentTarget.style.visibility="hidden"}}):e.jsx("div",{className:"preview-placeholder",children:"No main image"})}),e.jsxs("div",{className:"product-preview-body",children:[e.jsx("span",{className:"product-preview-title",children:t.title||"Untitled Product"}),e.jsxs("div",{className:"product-preview-row",children:[e.jsx("span",{children:"Price"}),e.jsx("strong",{children:t.price||"0.00"})]}),e.jsxs("div",{className:"product-preview-row",children:[e.jsx("span",{children:"Status"}),e.jsx("strong",{className:"status-text",children:t.status})]}),e.jsxs("div",{className:"product-preview-row",children:[e.jsx("span",{children:"Discount"}),e.jsxs("strong",{children:[t.discount||0,"%"]})]}),e.jsxs("div",{className:"product-preview-row",children:[e.jsx("span",{children:"Stock"}),e.jsxs("strong",{children:[t.quantity||0," units"]})]}),e.jsxs("div",{className:"product-preview-row",children:[e.jsx("span",{children:"Brand"}),e.jsx("strong",{children:t.brand.name||"Unassigned"})]}),e.jsxs("div",{className:"product-preview-row",children:[e.jsx("span",{children:"Category"}),e.jsx("strong",{children:t.category.name||"Unassigned"})]})]})]}),e.jsxs("div",{className:"card product-media-card",children:[e.jsxs("div",{className:"section-title",children:[e.jsx("h3",{children:"Media"}),e.jsx("span",{className:"hint",children:"Show the product clearly"})]}),e.jsx("label",{children:"Main Image URL"}),e.jsxs("div",{className:"image-input-row image-main-url-row",children:[e.jsx("input",{name:"img",placeholder:"https://example.com/image.jpg",value:t.img,onChange:h}),e.jsx("button",{type:"button",className:"btn secondary",onClick:()=>oe("main"),children:"Select Image URL"})]}),e.jsx("div",{className:"preview-row",children:e.jsx("div",{className:"preview",children:t.img?e.jsx("img",{src:t.img,alt:"Main Image Preview",onError:s=>{s.currentTarget.style.visibility="hidden"}}):e.jsx("div",{className:"preview-placeholder",children:"No main image"})})}),e.jsx("label",{children:"Additional Images"}),e.jsxs("div",{className:"actions",style:{marginTop:8},children:[e.jsx("button",{type:"button",className:"btn secondary",onClick:()=>oe("additional"),children:"Select Multiple Images"}),Array.isArray(t.imageURLs)&&t.imageURLs.length>0&&e.jsx("button",{type:"button",className:"btn ghost",onClick:()=>u(s=>({...s,imageURLs:[]})),children:"Clear All"})]}),e.jsx("div",{className:"subtext",children:"Choose images in Image Manager, then click Done to add the URLs."}),t.imageURLs&&t.imageURLs.length>0&&e.jsx("div",{className:"image-grid",children:w(t.imageURLs).map((s,a)=>e.jsxs("div",{className:"image-tile",children:[e.jsx("img",{src:s.img,alt:`Product image ${a+1}`,onError:n=>{n.currentTarget.style.visibility="hidden"}}),e.jsx("button",{type:"button",className:"image-remove",onClick:()=>be(a),children:"x"})]},a))}),(!t.imageURLs||t.imageURLs.length===0)&&e.jsx("div",{className:"image-empty",children:"No additional images added yet"})]})]}),e.jsx("div",{className:"card compact product-form-card",children:e.jsxs("form",{onSubmit:Ce,className:"product-form-grid",children:[e.jsxs("div",{className:"section appear",children:[e.jsxs("div",{className:"section-title",children:[e.jsx("h3",{children:"Basics"}),e.jsx("span",{className:"hint",children:"Key info customers see first"})]}),e.jsxs("div",{className:"form-table",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-cell",children:["Title *",e.jsx("span",{className:"subtext",children:"Keep it short and scannable"})]}),e.jsx("div",{className:"form-cell",children:e.jsx("input",{name:"title",placeholder:"Product title",value:t.title,onChange:h,required:!0})})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Price *"}),e.jsx("div",{className:"form-cell",children:e.jsx("input",{name:"price",type:"number",step:"0.01",placeholder:"0.00",value:t.price,onChange:h,required:!0})})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-cell",children:["Unit",e.jsx("span",{className:"subtext",children:"Numeric only"})]}),e.jsx("div",{className:"form-cell",children:e.jsx("input",{name:"unit",inputMode:"numeric",pattern:"[0-9]*",placeholder:"e.g., 3",value:t.unit,onChange:h})})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Quantity"}),e.jsx("div",{className:"form-cell",children:e.jsx("input",{name:"quantity",type:"number",placeholder:"0",value:t.quantity,onChange:h})})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Discount"}),e.jsx("div",{className:"form-cell",children:e.jsx("input",{name:"discount",type:"number",placeholder:"0",value:t.discount,onChange:h})})]})]})]}),e.jsxs("div",{className:"section appear delay-1",children:[e.jsxs("div",{className:"section-title",children:[e.jsx("h3",{children:"Classification"}),e.jsx("span",{className:"hint",children:"Organize products for better discovery"})]}),e.jsxs("div",{className:"form-table",children:[e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Parent"}),e.jsx("div",{className:"form-cell",children:e.jsx("input",{name:"parent",placeholder:"Parent",value:t.parent,onChange:h})})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Children *"}),e.jsx("div",{className:"form-cell",children:e.jsx("input",{name:"children",placeholder:"Children",value:t.children,onChange:h,required:!0})})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Product Type *"}),e.jsx("div",{className:"form-cell",children:e.jsx("input",{name:"productType",placeholder:"grocery, electronics",value:t.productType,onChange:h,required:!0})})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Status"}),e.jsx("div",{className:"form-cell",children:e.jsxs("div",{className:"status-row",children:[e.jsxs("select",{name:"status",value:t.status,onChange:h,children:[e.jsx("option",{value:"in-stock",children:"in-stock"}),e.jsx("option",{value:"out-of-stock",children:"out-of-stock"}),e.jsx("option",{value:"discontinued",children:"discontinued"})]}),e.jsxs("span",{className:"inline-badge",children:[e.jsx("span",{className:"dot"}),t.status]})]})})]})]})]}),e.jsxs("div",{className:"section appear delay-2",children:[e.jsxs("div",{className:"section-title",children:[e.jsx("h3",{children:"Brand & Category"}),e.jsx("span",{className:"hint",children:"Link product to its brand and category"})]}),e.jsxs("div",{className:"form-table",children:[e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Brand *"}),e.jsxs("div",{className:"form-cell",children:[e.jsxs("select",{value:t.brand.id||"",onChange:ve,required:!0,disabled:D,children:[e.jsx("option",{value:"",children:"-- Select a brand --"}),I.map((s,a)=>{const n=s._id||s.id||s.uuid||`temp_${a}`,r=s.name||s.brandName||s.title||`Brand ${a+1}`;return console.log(`Brand ${a}:`,{brandId:n,brandName:r,fullBrand:s}),e.jsx("option",{value:n,children:r},n)})]}),D&&e.jsx("span",{className:"subtext",children:"Loading brands..."}),!D&&I.length===0&&e.jsxs("span",{className:"subtext",children:["No brands available. ",e.jsx("a",{href:"/admin/brands/new",children:"Add a brand first"})]}),!D&&I.length>0&&e.jsxs("span",{className:"subtext",children:["Found ",I.length," brand(s)."]})]})]}),t.brand.name&&e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Selected Brand"}),e.jsx("div",{className:"form-cell",children:e.jsxs("span",{className:"inline-badge",children:[e.jsx("strong",{children:t.brand.name})," (ID: ",t.brand.id,")"]})})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Category *"}),e.jsxs("div",{className:"form-cell",children:[e.jsxs("select",{value:t.category.id||"",onChange:Ne,required:!0,disabled:E,children:[e.jsx("option",{value:"",children:"-- Select a category --"}),A.map((s,a)=>{const n=s._id||s.id||s.uuid||`temp_${a}`,r=s.parent||s.name||s.categoryName||s.title||`Category ${a+1}`;return console.log(`Category ${a}:`,{categoryId:n,categoryName:r,fullCategory:s}),e.jsx("option",{value:n,children:r},n)})]}),E&&e.jsx("span",{className:"subtext",children:"Loading categories..."}),!E&&A.length===0&&e.jsxs("span",{className:"subtext",children:["No categories available. ",e.jsx("a",{href:"/admin/categories/new",children:"Add a category first"})]}),!E&&A.length>0&&e.jsxs("span",{className:"subtext",children:["Found ",A.length," category(ies)."]})]})]}),t.category.name&&e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Selected Category"}),e.jsx("div",{className:"form-cell",children:e.jsxs("span",{className:"inline-badge",children:[e.jsx("strong",{children:t.category.name})," (ID: ",t.category.id,")"]})})]})]})]}),e.jsxs("div",{className:"section appear",style:{gridColumn:"1 / -1"},children:[e.jsxs("div",{className:"section-title",children:[e.jsx("h3",{children:"Description"}),e.jsx("span",{className:"hint",children:"Highlight benefits and key features"})]}),e.jsx("div",{className:"form-table",children:e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Description"}),e.jsx("div",{className:"form-cell",children:e.jsx("textarea",{name:"description",placeholder:"Describe the product",value:t.description,onChange:h,rows:5})})]})})]}),e.jsxs("div",{className:"section appear",style:{gridColumn:"1 / -1"},children:[e.jsxs("div",{className:"section-title",children:[e.jsx("h3",{children:"Offers"}),e.jsx("span",{className:"hint",children:"Optional promotional date range"})]}),e.jsxs("div",{className:"form-table",children:[e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Offer Start Date"}),e.jsx("div",{className:"form-cell",children:e.jsx("input",{type:"date",value:R,onChange:s=>j(s.target.value)})})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Offer End Date"}),e.jsx("div",{className:"form-cell",children:e.jsx("input",{type:"date",value:S,onChange:s=>K(s.target.value)})})]})]})]}),e.jsx("div",{className:"sticky-actions appear",style:{gridColumn:"1 / -1"},children:e.jsxs("div",{className:"actions",children:[e.jsx("button",{className:"btn",type:"submit",disabled:Q,children:Q?"Saving...":"Save Product"}),e.jsx("button",{className:"btn secondary",type:"button",onClick:()=>window.location.href="/admin/products",children:"Cancel"})]})})]})})]}),O&&e.jsx("div",{className:"image-manager-modal-overlay",role:"dialog","aria-modal":"true",onClick:M,children:e.jsxs("div",{className:"image-manager-modal-card",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"section-title",children:[e.jsx("h3",{children:P?"Select Main Image":"Select Additional Images"}),e.jsx("span",{className:"hint",children:P?"Click one image to auto-fill Main Image URL.":"Select multiple images and add all selected URLs automatically."})]}),e.jsxs("div",{className:"image-input-row image-input-row-three",children:[e.jsx("input",{value:J,onChange:s=>re(s.target.value),onKeyDown:s=>{s.key==="Enter"&&(s.preventDefault(),Y(s.currentTarget.value))},placeholder:"Search by image id or URL"}),e.jsx("button",{type:"button",className:"btn ghost",onClick:()=>Y(J),disabled:_,children:_?"Loading...":"Search"}),e.jsx("button",{type:"button",className:"btn secondary",onClick:M,children:"Close"})]}),ae&&e.jsx("div",{className:"error",style:{marginTop:8},children:ae}),e.jsx("div",{className:"image-manager-modal-body",children:e.jsxs("div",{className:"image-manager-grid",children:[te.map((s,a)=>e.jsxs("button",{type:"button",className:`image-tile selectable ${!P&&b[s.url]?"selected":""}`,onClick:()=>ye(s.url),children:[e.jsx("img",{src:s.url,alt:s.publicId||`manager-image-${a+1}`}),e.jsx("span",{className:"image-select-chip",children:P?"Set Main":b[s.url]?"Selected":"Select"})]},`${s.id}-${a}`)),!_&&!te.length&&e.jsx("div",{className:"image-empty",children:"No images found in image manager."})]})}),!P&&e.jsxs("div",{className:"image-manager-modal-footer",children:[e.jsxs("span",{className:"subtext",children:[U," selected"]}),e.jsx("button",{type:"button",className:"btn",onClick:we,disabled:!U,children:U?U===1?"Done (1 image)":`Done (${U} images)`:"Done"})]})]})})]})};export{Me as default};
