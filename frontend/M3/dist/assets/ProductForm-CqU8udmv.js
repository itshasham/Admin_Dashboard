import{a as ke,r as m,j as e,A as v}from"./index-23gl11xS.js";/* empty css                */const K={img:"",title:"",unit:"",parent:"",children:"",price:"",discount:0,quantity:0,brand:{name:"",id:""},category:{name:"",id:""},status:"in-stock",productType:"",description:"",imageURLs:[]},$e=o=>!o||typeof o!="object"?[]:Array.isArray(o.images)?o.images:Array.isArray(o.data)?o.data:o.data&&Array.isArray(o.data.images)?o.data.images:[],ue=o=>{const p=typeof o=="string"?o:(o==null?void 0:o.img)||(o==null?void 0:o.url)||"",t=String(p||"").trim();return t?{...typeof o=="object"&&o?o:{},img:t,color:typeof o=="object"&&(o==null?void 0:o.color)||{name:"default",value:"#000000"}}:null},w=o=>{const p=Array.isArray(o)?o:[],t=new Set,u=[];return p.forEach(U=>{const j=ue(U);if(!(j!=null&&j.img))return;const S=j.img.toLowerCase();t.has(S)||(t.add(S),u.push(j))}),u},Me=()=>{const{id:o}=ke(),p=!!o,[t,u]=m.useState(K),[U,j]=m.useState(""),[S,V]=m.useState(""),[Y,E]=m.useState(!1),[H,R]=m.useState(""),[C,Q]=m.useState([]),[M,T]=m.useState(!1),[A,Z]=m.useState([]),[P,B]=m.useState(!1),[q,G]=m.useState(!1),[O,W]=m.useState("additional"),[F,X]=m.useState(!1),[ee,I]=m.useState(""),[_,se]=m.useState(""),[ae,re]=m.useState([]),[N,J]=m.useState({}),k=()=>{try{const s=localStorage.getItem("adminToken");return s?{Authorization:`Bearer ${s}`}:{}}catch{return{}}},ge=()=>{const s=new Date,r=s.getFullYear(),i=String(s.getMonth()+1).padStart(2,"0"),a=String(s.getDate()).padStart(2,"0");return`${r}-${i}-${a}`},te=s=>{if(!s)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(s))return s;const r=new Date(s);if(!isNaN(r.getTime())){const i=r.getFullYear(),a=String(r.getMonth()+1).padStart(2,"0"),c=String(r.getDate()).padStart(2,"0");return`${i}-${a}-${c}`}return typeof s=="string"&&s.length>=10?s.slice(0,10):""},ie=s=>{if(s&&/^\d{4}-\d{2}-\d{2}$/.test(s))try{const r=new Date(`${s}T00:00:00.000Z`);return isNaN(r.getTime())?void 0:r.toISOString()}catch{return}},ne=s=>{var r;return typeof s=="string"?((r=s.match(/\d+/g))==null?void 0:r.join(""))||"":s},he=s=>{const r=Array.isArray(s)?s.map(i=>String(i||"").trim()).filter(Boolean):[];r.length&&u(i=>{const a=w(i.imageURLs),c=new Set(a.map(n=>n.img.toLowerCase())),l=[...a];return r.forEach(n=>{const d=n.toLowerCase();if(c.has(d))return;c.add(d);const g=ue(n);g&&l.push(g)}),{...i,imageURLs:l}})},pe=async()=>{var s;T(!0);try{console.log("Fetching brands from:",`${v}/brand/all`);const r=await fetch(`${v}/brand/all`,{headers:{...k()},cache:"no-store"});if(console.log("Brands API Status:",r.status,r.statusText),r.status===304){console.log("304 - Not modified, using cached data"),T(!1);return}const a=((s=r.headers.get("content-type"))==null?void 0:s.includes("application/json"))?await r.json().catch(()=>null):null;if(console.log("Brands API Response:",a),console.log("Response headers:",Object.fromEntries(r.headers.entries())),!r.ok)throw console.error("API Error:",r.status,a==null?void 0:a.message),new Error((a==null?void 0:a.message)||"Failed to load brands");let c=[];if(Array.isArray(a))c=a,console.log("Data is direct array");else if(a&&typeof a=="object"){const l=[a.data,a.brands,a.items,a.results,a.list,a.records];for(const n of l)if(Array.isArray(n)){c=n,console.log("Found brands in:",Object.keys(a).find(d=>a[d]===n));break}if(c.length===0){const n=(d,g=0)=>{if(g>3||!d||typeof d!="object")return null;for(const f in d){if(Array.isArray(d[f]))return d[f];const x=n(d[f],g+1);if(x)return x}return null};c=n(a)||[],c.length>0&&console.log("Found nested array")}}console.log("Final brands array:",c),console.log("Number of brands:",c.length),c.length>0&&console.log("First brand example:",c[0]),Q(Array.isArray(c)?c:[])}catch(r){console.error("Failed to load brands:",r),Q([])}finally{T(!1)}},fe=async()=>{var s;B(!0);try{console.log("Fetching categories from:",`${v}/category/all`);const r=await fetch(`${v}/category/all`,{headers:{...k()},cache:"no-store"});if(console.log("Categories API Status:",r.status,r.statusText),r.status===304){console.log("304 - Not modified, using cached data"),B(!1);return}const a=((s=r.headers.get("content-type"))==null?void 0:s.includes("application/json"))?await r.json().catch(()=>null):null;if(console.log("Categories API Response:",a),!r.ok)throw console.error("Categories API Error:",r.status,a==null?void 0:a.message),new Error((a==null?void 0:a.message)||"Failed to load categories");const l=(n=>n?Array.isArray(n)?n:Array.isArray(n.result)?n.result:Array.isArray(n.data)?n.data:n.data&&Array.isArray(n.data.result)?n.data.result:n.data&&Array.isArray(n.data.data)?n.data.data:[]:[])(a);console.log("Final categories array:",l),console.log("Number of categories:",l.length),l.length>0&&console.log("First category example:",l[0]),Z(Array.isArray(l)?l:[])}catch(r){console.error("Failed to load categories:",r),Z([])}finally{B(!1)}};m.useEffect(()=>{(async()=>{var r,i;if(p)try{const a=await fetch(`${v}/product/single-product/${o}`,{headers:{...k()}}),c=await a.json();if(!a.ok)throw new Error((c==null?void 0:c.message)||"Failed to load product");const l=(c==null?void 0:c.data)||(c==null?void 0:c.product)||c||K,n=ne(l.unit||"");u({...K,...l,unit:n,imageURLs:w(l==null?void 0:l.imageURLs)});const d=te((r=l==null?void 0:l.offerDate)==null?void 0:r.startDate)||ge(),g=te((i=l==null?void 0:l.offerDate)==null?void 0:i.endDate)||"";j(d),V(g)}catch(a){R(a.message||"Failed to load product")}})(),pe(),fe()},[o,p]);const z=async(s=_)=>{X(!0),I("");try{const r=new URL(`${v}/cloudinary/images`);String(s||"").trim()&&r.searchParams.set("q",String(s).trim());const i=await fetch(r.toString(),{headers:{...k()},cache:"no-store"}),a=await i.json().catch(()=>({}));if(!i.ok)throw new Error((a==null?void 0:a.message)||(a==null?void 0:a.error)||"Failed to load image manager");const c=$e(a).map((n,d)=>({id:(n==null?void 0:n._id)||(n==null?void 0:n.publicId)||(n==null?void 0:n.id)||`manager-image-${d}`,publicId:(n==null?void 0:n.publicId)||(n==null?void 0:n.id)||"",url:String((n==null?void 0:n.url)||(n==null?void 0:n.img)||"").trim()})).filter(n=>n.url),l=new Map;c.forEach(n=>{l.has(n.url)||l.set(n.url,n)}),re(Array.from(l.values()))}catch(r){I(r.message||"Failed to load image manager"),re([])}finally{X(!1)}};m.useEffect(()=>{q&&z()},[q]);const h=s=>{const{name:r,value:i}=s.target;if(r==="unit"){u(a=>({...a,unit:ne(i)}));return}u(a=>({...a,[r]:i}))},je=s=>{const r=s.target.value,i=C.find(a=>(a._id||a.id||a.uuid)===r);if(console.log("Selected brand:",i),i){const a=i._id||i.id||i.uuid||"",c=i.name||i.brandName||i.title||"";u(l=>({...l,brand:{name:c,id:a}}))}else u(a=>({...a,brand:{name:"",id:""}}))},xe=s=>{const r=s.target.value,i=A.find(a=>(a._id||a.id||a.uuid)===r);if(console.log("Selected category:",i),i){const a=i._id||i.id||i.uuid||"",c=i.parent||i.name||i.categoryName||i.title||"";u(l=>({...l,category:{name:c,id:a}}))}else u(a=>({...a,category:{name:"",id:""}}))},ve=s=>{u(r=>({...r,imageURLs:w(r.imageURLs).filter((i,a)=>a!==s)}))},ce=(s="additional")=>{W(s==="main"?"main":"additional"),J({}),I(""),G(!0)},D=()=>{G(!1),W("additional"),J({}),I(""),se("")},Ne=s=>{const r=String(s||"").trim();if(r){if(O==="main"){u(i=>({...i,img:r})),D();return}J(i=>({...i,[r]:!i[r]}))}},be=()=>{if(O==="main")return;const s=Object.keys(N).filter(r=>N[r]);if(!s.length){I("Select at least one image.");return}he(s),D()},le=Object.keys(N).filter(s=>N[s]).length,$=O==="main",ye=s=>{var r;if(!s)return"Validation failed";if(typeof s.message=="string"&&s.message.trim())return s.message;if(s.errors&&typeof s.errors=="object"){const i=Object.keys(s.errors)[0];if(i){const a=s.errors[i];if(Array.isArray(a)&&a[0])return`${i}: ${a[0]}`;if(typeof a=="string")return`${i}: ${a}`;if(a&&typeof a.message=="string")return`${i}: ${a.message}`}}return Array.isArray(s.details)&&((r=s.details[0])!=null&&r.message)?s.details[0].message:"Validation error. Please check your inputs."},we=()=>{var r,i,a,c,l,n,d,g,f,x,b;const s=[];return(r=t.title)!=null&&r.trim()||s.push("Title is required"),(!t.price||t.price<=0)&&s.push("Valid price is required"),(a=(i=t.brand)==null?void 0:i.name)!=null&&a.trim()||s.push("Brand name is required"),(l=(c=t.brand)==null?void 0:c.id)!=null&&l.trim()||s.push("Brand ID is required"),(d=(n=t.category)==null?void 0:n.name)!=null&&d.trim()||s.push("Category name is required"),(f=(g=t.category)==null?void 0:g.id)!=null&&f.trim()||s.push("Category ID is required"),(x=t.children)!=null&&x.trim()||s.push("Children field is required"),(b=t.productType)!=null&&b.trim()||s.push("Product type is required"),s},Se=async s=>{var i,a,c,l,n,d,g,f,x;s.preventDefault(),E(!0),R("");const r=we();if(r.length>0){R(r.join(". ")+"."),E(!1),window.scrollTo({top:0,behavior:"smooth"});return}try{const b=p?`${v}/product/edit-product/${o}`:`${v}/product/add`,Ce=p?"PATCH":"POST",oe={img:t.img,title:t.title,unit:t.unit,parent:t.parent,children:t.children,price:t.price===""?void 0:Number(t.price),discount:t.discount===""?void 0:Number(t.discount),quantity:t.quantity===""?void 0:Number(t.quantity),brand:{name:((i=t.brand)==null?void 0:i.name)||"",id:((a=t.brand)==null?void 0:a.id)||""},category:{name:((c=t.category)==null?void 0:c.name)||"",id:((l=t.category)==null?void 0:l.id)||""},status:t.status,productType:t.productType,description:t.description,imageURLs:w(t.imageURLs)},de=ie(U),me=ie(S);de&&me&&(oe.offerDate={startDate:de,endDate:me});const Ae={...oe,brand:{name:((n=t.brand)==null?void 0:n.name)||"",id:((d=t.brand)==null?void 0:d.id)||""},category:{name:((g=t.category)==null?void 0:g.name)||"",id:((f=t.category)==null?void 0:f.id)||""},children:t.children||"",imageURLs:w(t.imageURLs)},y=await fetch(b,{method:Ce,headers:{"Content-Type":"application/json",...k()},body:JSON.stringify(Ae)}),L=((x=y.headers.get("content-type"))==null?void 0:x.includes("application/json"))?await y.json().catch(()=>({})):{};if(!y.ok){const Ie=y.status===400?ye(L):(L==null?void 0:L.message)||`Save failed (${y.status})`;throw console.error("Product save error",{status:y.status,data:L}),new Error(Ie)}window.location.href="/admin/products"}catch(b){R(b.message||"Save failed"),window.scrollTo({top:0,behavior:"smooth"})}finally{E(!1)}};return e.jsxs("div",{className:"page-container",children:[e.jsxs("div",{className:"page-header fancy",children:[e.jsxs("div",{children:[e.jsx("h2",{children:p?"Edit Product":"New Product"}),e.jsx("p",{className:"muted",children:"Create product entries with confidence and clarity"})]}),e.jsx("button",{className:"btn secondary",type:"button",onClick:()=>window.location.href="/admin/dashboard",children:"â† Back"})]}),H&&e.jsx("div",{className:"error",children:H}),e.jsxs("div",{className:"product-form-shell",children:[e.jsxs("div",{className:"product-side",children:[e.jsxs("div",{className:"card product-preview-card",children:[e.jsx("div",{className:"product-preview-media",children:t.img?e.jsx("img",{src:t.img,alt:"Product preview",onError:s=>{s.currentTarget.style.visibility="hidden"}}):e.jsx("div",{className:"preview-placeholder",children:"No main image"})}),e.jsxs("div",{className:"product-preview-body",children:[e.jsx("span",{className:"product-preview-title",children:t.title||"Untitled Product"}),e.jsxs("div",{className:"product-preview-row",children:[e.jsx("span",{children:"Price"}),e.jsx("strong",{children:t.price||"0.00"})]}),e.jsxs("div",{className:"product-preview-row",children:[e.jsx("span",{children:"Status"}),e.jsx("strong",{className:"status-text",children:t.status})]}),e.jsxs("div",{className:"product-preview-row",children:[e.jsx("span",{children:"Discount"}),e.jsxs("strong",{children:[t.discount||0,"%"]})]}),e.jsxs("div",{className:"product-preview-row",children:[e.jsx("span",{children:"Stock"}),e.jsxs("strong",{children:[t.quantity||0," units"]})]}),e.jsxs("div",{className:"product-preview-row",children:[e.jsx("span",{children:"Brand"}),e.jsx("strong",{children:t.brand.name||"Unassigned"})]}),e.jsxs("div",{className:"product-preview-row",children:[e.jsx("span",{children:"Category"}),e.jsx("strong",{children:t.category.name||"Unassigned"})]})]})]}),e.jsxs("div",{className:"card product-media-card",children:[e.jsxs("div",{className:"section-title",children:[e.jsx("h3",{children:"Media"}),e.jsx("span",{className:"hint",children:"Show the product clearly"})]}),e.jsx("label",{children:"Main Image URL"}),e.jsxs("div",{className:"image-input-row image-main-url-row",children:[e.jsx("input",{name:"img",placeholder:"https://example.com/image.jpg",value:t.img,onChange:h}),e.jsx("button",{type:"button",className:"btn secondary",onClick:()=>ce("main"),children:"Select Image URL"})]}),e.jsx("div",{className:"preview-row",children:e.jsx("div",{className:"preview",children:t.img?e.jsx("img",{src:t.img,alt:"Main Image Preview",onError:s=>{s.currentTarget.style.visibility="hidden"}}):e.jsx("div",{className:"preview-placeholder",children:"No main image"})})}),e.jsx("label",{children:"Additional Images"}),e.jsxs("div",{className:"actions",style:{marginTop:8},children:[e.jsx("button",{type:"button",className:"btn secondary",onClick:()=>ce("additional"),children:"Select Multiple Images"}),Array.isArray(t.imageURLs)&&t.imageURLs.length>0&&e.jsx("button",{type:"button",className:"btn ghost",onClick:()=>u(s=>({...s,imageURLs:[]})),children:"Clear All"})]}),e.jsx("div",{className:"subtext",children:"Choose images from Image Manager and URLs are auto-added."}),t.imageURLs&&t.imageURLs.length>0&&e.jsx("div",{className:"image-grid",children:w(t.imageURLs).map((s,r)=>e.jsxs("div",{className:"image-tile",children:[e.jsx("img",{src:s.img,alt:`Product image ${r+1}`,onError:i=>{i.currentTarget.style.visibility="hidden"}}),e.jsx("button",{type:"button",className:"image-remove",onClick:()=>ve(r),children:"x"})]},r))}),(!t.imageURLs||t.imageURLs.length===0)&&e.jsx("div",{className:"image-empty",children:"No additional images added yet"})]})]}),e.jsx("div",{className:"card compact product-form-card",children:e.jsxs("form",{onSubmit:Se,className:"product-form-grid",children:[e.jsxs("div",{className:"section appear",children:[e.jsxs("div",{className:"section-title",children:[e.jsx("h3",{children:"Basics"}),e.jsx("span",{className:"hint",children:"Key info customers see first"})]}),e.jsxs("div",{className:"form-table",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-cell",children:["Title *",e.jsx("span",{className:"subtext",children:"Keep it short and scannable"})]}),e.jsx("div",{className:"form-cell",children:e.jsx("input",{name:"title",placeholder:"Product title",value:t.title,onChange:h,required:!0})})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Price *"}),e.jsx("div",{className:"form-cell",children:e.jsx("input",{name:"price",type:"number",step:"0.01",placeholder:"0.00",value:t.price,onChange:h,required:!0})})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-cell",children:["Unit",e.jsx("span",{className:"subtext",children:"Numeric only"})]}),e.jsx("div",{className:"form-cell",children:e.jsx("input",{name:"unit",inputMode:"numeric",pattern:"[0-9]*",placeholder:"e.g., 3",value:t.unit,onChange:h})})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Quantity"}),e.jsx("div",{className:"form-cell",children:e.jsx("input",{name:"quantity",type:"number",placeholder:"0",value:t.quantity,onChange:h})})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Discount"}),e.jsx("div",{className:"form-cell",children:e.jsx("input",{name:"discount",type:"number",placeholder:"0",value:t.discount,onChange:h})})]})]})]}),e.jsxs("div",{className:"section appear delay-1",children:[e.jsxs("div",{className:"section-title",children:[e.jsx("h3",{children:"Classification"}),e.jsx("span",{className:"hint",children:"Organize products for better discovery"})]}),e.jsxs("div",{className:"form-table",children:[e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Parent"}),e.jsx("div",{className:"form-cell",children:e.jsx("input",{name:"parent",placeholder:"Parent",value:t.parent,onChange:h})})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Children *"}),e.jsx("div",{className:"form-cell",children:e.jsx("input",{name:"children",placeholder:"Children",value:t.children,onChange:h,required:!0})})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Product Type *"}),e.jsx("div",{className:"form-cell",children:e.jsx("input",{name:"productType",placeholder:"grocery, electronics",value:t.productType,onChange:h,required:!0})})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Status"}),e.jsx("div",{className:"form-cell",children:e.jsxs("div",{className:"status-row",children:[e.jsxs("select",{name:"status",value:t.status,onChange:h,children:[e.jsx("option",{value:"in-stock",children:"in-stock"}),e.jsx("option",{value:"out-of-stock",children:"out-of-stock"}),e.jsx("option",{value:"discontinued",children:"discontinued"})]}),e.jsxs("span",{className:"inline-badge",children:[e.jsx("span",{className:"dot"}),t.status]})]})})]})]})]}),e.jsxs("div",{className:"section appear delay-2",children:[e.jsxs("div",{className:"section-title",children:[e.jsx("h3",{children:"Brand & Category"}),e.jsx("span",{className:"hint",children:"Link product to its brand and category"})]}),e.jsxs("div",{className:"form-table",children:[e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Brand *"}),e.jsxs("div",{className:"form-cell",children:[e.jsxs("select",{value:t.brand.id||"",onChange:je,required:!0,disabled:M,children:[e.jsx("option",{value:"",children:"-- Select a brand --"}),C.map((s,r)=>{const i=s._id||s.id||s.uuid||`temp_${r}`,a=s.name||s.brandName||s.title||`Brand ${r+1}`;return console.log(`Brand ${r}:`,{brandId:i,brandName:a,fullBrand:s}),e.jsx("option",{value:i,children:a},i)})]}),M&&e.jsx("span",{className:"subtext",children:"Loading brands..."}),!M&&C.length===0&&e.jsxs("span",{className:"subtext",children:["No brands available. ",e.jsx("a",{href:"/admin/brands/new",children:"Add a brand first"})]}),!M&&C.length>0&&e.jsxs("span",{className:"subtext",children:["Found ",C.length," brand(s)."]})]})]}),t.brand.name&&e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Selected Brand"}),e.jsx("div",{className:"form-cell",children:e.jsxs("span",{className:"inline-badge",children:[e.jsx("strong",{children:t.brand.name})," (ID: ",t.brand.id,")"]})})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Category *"}),e.jsxs("div",{className:"form-cell",children:[e.jsxs("select",{value:t.category.id||"",onChange:xe,required:!0,disabled:P,children:[e.jsx("option",{value:"",children:"-- Select a category --"}),A.map((s,r)=>{const i=s._id||s.id||s.uuid||`temp_${r}`,a=s.parent||s.name||s.categoryName||s.title||`Category ${r+1}`;return console.log(`Category ${r}:`,{categoryId:i,categoryName:a,fullCategory:s}),e.jsx("option",{value:i,children:a},i)})]}),P&&e.jsx("span",{className:"subtext",children:"Loading categories..."}),!P&&A.length===0&&e.jsxs("span",{className:"subtext",children:["No categories available. ",e.jsx("a",{href:"/admin/categories/new",children:"Add a category first"})]}),!P&&A.length>0&&e.jsxs("span",{className:"subtext",children:["Found ",A.length," category(ies)."]})]})]}),t.category.name&&e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Selected Category"}),e.jsx("div",{className:"form-cell",children:e.jsxs("span",{className:"inline-badge",children:[e.jsx("strong",{children:t.category.name})," (ID: ",t.category.id,")"]})})]})]})]}),e.jsxs("div",{className:"section appear",style:{gridColumn:"1 / -1"},children:[e.jsxs("div",{className:"section-title",children:[e.jsx("h3",{children:"Description"}),e.jsx("span",{className:"hint",children:"Highlight benefits and key features"})]}),e.jsx("div",{className:"form-table",children:e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Description"}),e.jsx("div",{className:"form-cell",children:e.jsx("textarea",{name:"description",placeholder:"Describe the product",value:t.description,onChange:h,rows:5})})]})})]}),e.jsxs("div",{className:"section appear",style:{gridColumn:"1 / -1"},children:[e.jsxs("div",{className:"section-title",children:[e.jsx("h3",{children:"Offers"}),e.jsx("span",{className:"hint",children:"Optional promotional date range"})]}),e.jsxs("div",{className:"form-table",children:[e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Offer Start Date"}),e.jsx("div",{className:"form-cell",children:e.jsx("input",{type:"date",value:U,onChange:s=>j(s.target.value)})})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("div",{className:"form-cell",children:"Offer End Date"}),e.jsx("div",{className:"form-cell",children:e.jsx("input",{type:"date",value:S,onChange:s=>V(s.target.value)})})]})]})]}),e.jsx("div",{className:"sticky-actions appear",style:{gridColumn:"1 / -1"},children:e.jsxs("div",{className:"actions",children:[e.jsx("button",{className:"btn",type:"submit",disabled:Y,children:Y?"Saving...":"Save Product"}),e.jsx("button",{className:"btn secondary",type:"button",onClick:()=>window.location.href="/admin/products",children:"Cancel"})]})})]})})]}),q&&e.jsx("div",{className:"image-manager-modal-overlay",role:"dialog","aria-modal":"true",onClick:D,children:e.jsxs("div",{className:"image-manager-modal-card",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"section-title",children:[e.jsx("h3",{children:$?"Select Main Image":"Select Additional Images"}),e.jsx("span",{className:"hint",children:$?"Click one image to auto-fill Main Image URL.":"Select multiple images and add all selected URLs automatically."})]}),e.jsxs("div",{className:"image-input-row image-input-row-three",children:[e.jsx("input",{value:_,onChange:s=>se(s.target.value),onKeyDown:s=>{s.key==="Enter"&&(s.preventDefault(),z(s.currentTarget.value))},placeholder:"Search by image id or URL"}),e.jsx("button",{type:"button",className:"btn ghost",onClick:()=>z(_),disabled:F,children:F?"Loading...":"Search"}),e.jsx("button",{type:"button",className:"btn secondary",onClick:D,children:"Close"})]}),ee&&e.jsx("div",{className:"error",style:{marginTop:8},children:ee}),e.jsxs("div",{className:"image-manager-grid",children:[ae.map((s,r)=>e.jsxs("button",{type:"button",className:`image-tile selectable ${!$&&N[s.url]?"selected":""}`,onClick:()=>Ne(s.url),children:[e.jsx("img",{src:s.url,alt:s.publicId||`manager-image-${r+1}`}),e.jsx("span",{className:"image-select-chip",children:$?"Set Main":N[s.url]?"Selected":"Select"})]},`${s.id}-${r}`)),!F&&!ae.length&&e.jsx("div",{className:"image-empty",children:"No images found in image manager."})]}),!$&&e.jsxs("div",{className:"actions",style:{justifyContent:"flex-end",marginTop:12},children:[e.jsxs("span",{className:"subtext",children:[le," selected"]}),e.jsx("button",{type:"button",className:"btn",onClick:be,disabled:!le,children:"Add Selected Images"})]})]})})]})};export{Me as default};
