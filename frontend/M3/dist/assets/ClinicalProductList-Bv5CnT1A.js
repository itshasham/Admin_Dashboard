import{r as d,j as r,A as o}from"./index-BmyIwrNX.js";/* empty css                */const b=a=>Array.isArray(a)?a:!a||typeof a!="object"?[]:Array.isArray(a.data)?a.data:Array.isArray(a.items)?a.items:Array.isArray(a.products)?a.products:a.data&&Array.isArray(a.data.data)?a.data.data:[],A=a=>{const n=String((a==null?void 0:a.productType)||"").toLowerCase(),l=String((a==null?void 0:a.parent)||"").toLowerCase();return n==="clinical"||l==="clinical"||!!(a!=null&&a.inquiryOnly||a!=null&&a.isInquiryOnly)},C=()=>{const[a,n]=d.useState([]),[l,u]=d.useState(!1),[h,j]=d.useState(""),i=()=>{try{const s=localStorage.getItem("adminToken");return s?{Authorization:`Bearer ${s}`}:{}}catch{return{}}},x=async()=>{u(!0),j("");try{const s=new URL(`${o}/clinical-products`);s.searchParams.set("page","1"),s.searchParams.set("limit","200");let c=await fetch(s.toString(),{headers:{...i()},cache:"no-store"}),t=await c.json().catch(()=>null);if(!c.ok&&c.status===404&&(c=await fetch(`${o}/product/all`,{headers:{...i()},cache:"no-store"}),t=await c.json().catch(()=>null)),!c.ok)throw new Error((t==null?void 0:t.message)||"Failed to load clinical products");const e=b(t);n(c.url.includes("/product/all")?e.filter(A):e)}catch(s){n([]),j(s.message||"Failed to load clinical products")}finally{u(!1)}};d.useEffect(()=>{x()},[]);const w=async s=>{if(s&&window.confirm("Delete this clinical product?"))try{let c=await fetch(`${o}/clinical-products/${s}`,{method:"DELETE",headers:{...i()}}),t=await c.json().catch(()=>({}));if(!c.ok&&c.status===404&&(c=await fetch(`${o}/product/${s}`,{method:"DELETE",headers:{...i()}}),t=await c.json().catch(()=>({}))),!c.ok)throw new Error((t==null?void 0:t.message)||"Delete failed");await x()}catch(c){alert(c.message||"Delete failed")}};return r.jsxs("div",{className:"page-container",children:[r.jsxs("div",{className:"page-header",children:[r.jsxs("div",{children:[r.jsx("h2",{children:"Clinical Products"}),r.jsx("p",{className:"muted",children:"Inquiry-first products for customer view. Orders are handled via email/WhatsApp."})]}),r.jsxs("div",{className:"actions",children:[r.jsx("button",{className:"btn secondary",onClick:()=>window.location.href="/admin/dashboard",children:"â† Back"}),r.jsx("button",{className:"btn",onClick:()=>window.location.href="/admin/clinical-products/new",children:"+ Add Clinical Product"})]})]}),l&&r.jsx("div",{children:"Loading..."}),h&&r.jsx("div",{className:"error",children:h}),!l&&!h&&r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Image"}),r.jsx("th",{children:"Title"}),r.jsx("th",{children:"Category"}),r.jsx("th",{children:"Contact"}),r.jsx("th",{children:"Inquiry Mode"}),r.jsx("th",{children:"Actions"})]})}),r.jsxs("tbody",{children:[a.map((s,c)=>{var f,p,g;const t=(s==null?void 0:s._id)||(s==null?void 0:s.id),e=(s==null?void 0:s.img)||((p=(f=s==null?void 0:s.imageURLs)==null?void 0:f[0])==null?void 0:p.img)||"";return r.jsxs("tr",{children:[r.jsx("td",{children:e?r.jsx("img",{className:"brand-thumb",src:e,alt:(s==null?void 0:s.title)||"clinical-product"}):r.jsx("div",{className:"brand-thumb",style:{visibility:"hidden"}})}),r.jsx("td",{children:(s==null?void 0:s.title)||"-"}),r.jsx("td",{children:((g=s==null?void 0:s.category)==null?void 0:g.name)||"-"}),r.jsx("td",{children:r.jsxs("div",{style:{display:"grid",gap:3},children:[r.jsx("small",{children:(s==null?void 0:s.contactEmail)||"No email"}),r.jsx("small",{children:(s==null?void 0:s.whatsappNumber)||"No WhatsApp"})]})}),r.jsx("td",{children:s!=null&&s.inquiryOnly?"Inquiry Only":"Standard"}),r.jsx("td",{children:r.jsxs("div",{className:"actions",children:[r.jsx("button",{className:"btn",disabled:!t,onClick:()=>window.location.href=`/admin/clinical-products/${t}`,children:"Edit"}),r.jsx("button",{className:"btn danger",disabled:!t,onClick:()=>w(t),children:"Delete"})]})})]},t||c)}),!a.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"muted",children:"No clinical products found."})})]})]})]})};export{C as default};
