import{r as c,j as e,A as g}from"./index-CPlrO2ek.js";/* empty css              */const D=()=>{const[l,y]=c.useState([]),[v,j]=c.useState(!1),[o,p]=c.useState(""),[m,b]=c.useState(""),[d,A]=c.useState("all"),w=()=>{try{const s=localStorage.getItem("adminToken");return s?{Authorization:`Bearer ${s}`}:{}}catch{return{}}},S=s=>s?Array.isArray(s)?s:Array.isArray(s.data)?s.data:Array.isArray(s.orders)?s.orders:s.data&&Array.isArray(s.data.orders)?s.data.orders:[]:[],N=async()=>{var s;j(!0),p("");try{console.log("Fetching orders from:",`${g}/order/orders`);const a=await fetch(`${g}/order/orders`,{headers:{...w()},cache:"no-store"});console.log("Orders API Response Status:",a.status,a.statusText);const n=((s=a.headers.get("content-type"))==null?void 0:s.includes("application/json"))?await a.json().catch(()=>null):null;if(console.log("Orders API Response Data:",n),!a.ok)throw new Error((n==null?void 0:n.message)||"Failed to load orders");const i=S(n);console.log("Processed Orders Array:",i),console.log("Order IDs:",i.map(r=>({id:r==null?void 0:r._id,invoice:r==null?void 0:r.invoice,hasId:!!(r!=null&&r._id)}))),y(i)}catch(a){console.error("Failed to load orders:",a),p(a.message||"Failed to load orders")}finally{j(!1)}};c.useEffect(()=>{N()},[]);const u=s=>{const a=String(s||"").toLowerCase();return a==="cancelled"||a==="canceled"?"cancel":a==="delivered"||a==="dispatched"?"dispatch":a},h=c.useMemo(()=>{const s=m.trim().toLowerCase();return l.filter(a=>{const t=u(a==null?void 0:a.status);return d!=="all"&&t!==d?!1:s?[a==null?void 0:a.invoice,a==null?void 0:a.name,a==null?void 0:a.user,a==null?void 0:a.email,a==null?void 0:a.paymentMethod,a==null?void 0:a.status].filter(Boolean).join(" ").toLowerCase().includes(s):!0})},[l,m,d]),x=c.useMemo(()=>{const s={pending:0,processing:0,dispatch:0,cancel:0};let a=0;return l.forEach(t=>{const n=u(t==null?void 0:t.status);s[n]!==void 0&&(s[n]+=1);const i=Number(t==null?void 0:t.totalAmount);Number.isNaN(i)||(a+=i)}),{counts:s,revenue:a}},[l]),f=s=>{const a=Number(s);return Number.isNaN(a)?"-":new Intl.NumberFormat("en-US",{maximumFractionDigits:2}).format(a)},k=s=>{try{return s?new Date(s).toLocaleDateString():"-"}catch{return"-"}},C=s=>{const a=u(s);return a==="dispatch"?"status-badge status-success":a==="processing"?"status-badge status-info":a==="cancel"?"status-badge status-danger":a==="pending"?"status-badge status-warn":"status-badge status-neutral"};return v?e.jsx("div",{children:"Loading..."}):o?e.jsx("div",{className:"error",children:o}):e.jsxs("div",{className:"page-container",children:[e.jsxs("div",{className:"page-header fancy",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"Orders"}),e.jsx("p",{className:"muted",children:"Track fulfillment, payment, and customer details in one place"})]}),e.jsxs("div",{className:"actions",children:[e.jsx("button",{className:"btn secondary",onClick:()=>window.location.href="/admin/dashboard",children:"â† Back"}),e.jsx("button",{className:"btn",onClick:N,children:"Refresh"})]})]}),e.jsxs("div",{className:"summary-grid",children:[e.jsxs("div",{className:"summary-card",children:[e.jsx("span",{className:"summary-label",children:"Total Orders"}),e.jsx("span",{className:"summary-value",children:l.length}),e.jsxs("span",{className:"summary-chip",children:[h.length," visible"]})]}),e.jsxs("div",{className:"summary-card",children:[e.jsx("span",{className:"summary-label",children:"Revenue"}),e.jsx("span",{className:"summary-value",children:f(x.revenue)}),e.jsx("span",{className:"summary-chip",children:"All time"})]}),e.jsxs("div",{className:"summary-card",children:[e.jsx("span",{className:"summary-label",children:"Pending"}),e.jsx("span",{className:"summary-value",children:x.counts.pending}),e.jsx("span",{className:"summary-chip",children:"Needs action"})]}),e.jsxs("div",{className:"summary-card",children:[e.jsx("span",{className:"summary-label",children:"Dispatch"}),e.jsx("span",{className:"summary-value",children:x.counts.dispatch}),e.jsx("span",{className:"summary-chip",children:"In transit"})]})]}),e.jsxs("div",{className:"table-toolbar",children:[e.jsx("div",{className:"search-input",children:e.jsx("input",{type:"search",placeholder:"Search by invoice, customer, email, or status",value:m,onChange:s=>b(s.target.value)})}),e.jsx("div",{className:"pill-row",children:["all","pending","processing","dispatch","cancel"].map(s=>e.jsx("button",{className:`filter-pill ${d===s?"active":""}`,onClick:()=>A(s),children:s},s))})]}),e.jsxs("div",{className:"card table-card",children:[e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Invoice"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Payment"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Total"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:h.map((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{children:(s==null?void 0:s.invoice)||"-"}),e.jsx("td",{children:(s==null?void 0:s.name)||(s==null?void 0:s.user)||(s==null?void 0:s.email)||"-"}),e.jsx("td",{children:(s==null?void 0:s.paymentMethod)||"-"}),e.jsx("td",{children:k(s==null?void 0:s.createdAt)}),e.jsx("td",{children:f(s==null?void 0:s.totalAmount)}),e.jsx("td",{children:e.jsx("span",{className:C(s==null?void 0:s.status),children:u(s==null?void 0:s.status)||"pending"})}),e.jsx("td",{children:e.jsx("div",{className:"actions",children:s!=null&&s._id?e.jsx("button",{className:"btn",onClick:()=>window.location.href=`/admin/orders/${s._id}`,children:"View"}):e.jsx("span",{className:"subtext",children:"No ID"})})})]},(s==null?void 0:s._id)||a))})]})}),!h.length&&e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:"No orders match your filters."})})]})]})};export{D as default};
