import{r as d,j as r,A as u}from"./index-C1zVYYn4.js";/* empty css                */const b=e=>Array.isArray(e)?e:!e||typeof e!="object"?[]:Array.isArray(e.data)?e.data:Array.isArray(e.items)?e.items:Array.isArray(e.machines)?e.machines:[],N=()=>{const[e,n]=d.useState([]),[i,o]=d.useState(!1),[a,c]=d.useState(""),h=()=>{try{const s=localStorage.getItem("adminToken");return s?{Authorization:`Bearer ${s}`}:{}}catch{return{}}},j=async()=>{o(!0),c("");try{const s=new URL(`${u}/machines`);s.searchParams.set("page","1"),s.searchParams.set("limit","200");const l=await fetch(s.toString(),{cache:"no-store"}),t=await l.json().catch(()=>null);if(!l.ok)throw new Error((t==null?void 0:t.message)||"Failed to load machines");n(b(t))}catch(s){n([]),c(s.message||"Failed to load machines")}finally{o(!1)}};d.useEffect(()=>{j()},[]);const f=async s=>{if(s&&window.confirm("Delete this machine?"))try{const l=await fetch(`${u}/machines/${s}`,{method:"DELETE",headers:{...h()}}),t=await l.json().catch(()=>({}));if(!l.ok)throw new Error((t==null?void 0:t.message)||"Delete failed");await j()}catch(l){alert(l.message||"Delete failed")}};return r.jsxs("div",{className:"page-container",children:[r.jsxs("div",{className:"page-header",children:[r.jsxs("div",{children:[r.jsx("h2",{children:"Machines"}),r.jsx("p",{className:"muted",children:"Machine catalog for customer view and inquiry via email/WhatsApp."})]}),r.jsxs("div",{className:"actions",children:[r.jsx("button",{className:"btn secondary",onClick:()=>window.location.href="/admin/dashboard",children:"â† Back"}),r.jsx("button",{className:"btn",onClick:()=>window.location.href="/admin/machines/new",children:"+ Add Machine"})]})]}),i&&r.jsx("div",{children:"Loading..."}),a&&r.jsx("div",{className:"error",children:a}),!i&&!a&&r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Image"}),r.jsx("th",{children:"Name"}),r.jsx("th",{children:"Model"}),r.jsx("th",{children:"Brand"}),r.jsx("th",{children:"Availability"}),r.jsx("th",{children:"Contact"}),r.jsx("th",{children:"Product URL"}),r.jsx("th",{children:"Actions"})]})}),r.jsxs("tbody",{children:[e.map((s,l)=>{const t=(s==null?void 0:s._id)||(s==null?void 0:s.id),x=Array.isArray(s==null?void 0:s.images)?s.images[0]:"";return r.jsxs("tr",{children:[r.jsx("td",{children:x?r.jsx("img",{className:"brand-thumb",src:x,alt:(s==null?void 0:s.name)||"machine"}):r.jsx("div",{className:"brand-thumb",style:{visibility:"hidden"}})}),r.jsx("td",{children:(s==null?void 0:s.name)||"-"}),r.jsx("td",{children:(s==null?void 0:s.modelNumber)||"-"}),r.jsx("td",{children:(s==null?void 0:s.brand)||"-"}),r.jsx("td",{children:(s==null?void 0:s.availability)||"-"}),r.jsx("td",{children:r.jsxs("div",{style:{display:"grid",gap:3},children:[r.jsx("small",{children:(s==null?void 0:s.contactEmail)||"No email"}),r.jsx("small",{children:(s==null?void 0:s.whatsappNumber)||"No WhatsApp"})]})}),r.jsx("td",{children:s!=null&&s.productUrl?r.jsx("a",{href:s.productUrl,target:"_blank",rel:"noreferrer",children:"Open Link"}):r.jsx("small",{className:"muted",children:"No URL"})}),r.jsx("td",{children:r.jsxs("div",{className:"actions",children:[r.jsx("button",{className:"btn",disabled:!t,onClick:()=>window.location.href=`/admin/machines/${t}`,children:"Edit"}),r.jsx("button",{className:"btn secondary",disabled:!(s!=null&&s.productUrl),onClick:()=>window.open(s.productUrl,"_blank","noopener,noreferrer"),children:"Visit"}),r.jsx("button",{className:"btn danger",disabled:!t,onClick:()=>f(t),children:"Delete"})]})})]},t||l)}),!e.length&&r.jsx("tr",{children:r.jsx("td",{colSpan:8,className:"muted",children:"No machines found."})})]})]})]})};export{N as default};
