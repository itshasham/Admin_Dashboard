import{r as i,j as e,A as m}from"./index-23gl11xS.js";/* empty css                */const y=()=>{const[j,f]=i.useState([]),[x,c]=i.useState(!1),[a,o]=i.useState(""),d=()=>{try{const t=localStorage.getItem("adminToken");return t?{Authorization:`Bearer ${t}`}:{}}catch{return{}}},b=t=>{if(Array.isArray(t))return t;if(!t||typeof t!="object")return[];if(Array.isArray(t.data))return t.data;if(Array.isArray(t.products))return t.products;if(t.data&&Array.isArray(t.data.data))return t.data.data;const r=[t.items,t.docs,t.result,t.rows,t.list];for(const s of r)if(Array.isArray(s))return s;return[]},l=async()=>{var t;c(!0),o("");try{const r=await fetch(`${m}/product/all`,{headers:{...d()},cache:"no-store"}),n=((t=r.headers.get("content-type"))==null?void 0:t.includes("application/json"))?await r.json().catch(()=>null):null;if(!r.ok)throw new Error((n==null?void 0:n.message)||"Failed to load products");f(b(n))}catch(r){o(r.message||"Failed to load products")}finally{c(!1)}},w=async t=>{if(!t)return alert("Missing product id");if(window.confirm("Delete this product?"))try{const r=await fetch(`${m}/product/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json",...d()}}),s=await r.json().catch(()=>({}));if(!r.ok)throw new Error((s==null?void 0:s.message)||"Delete failed");await l()}catch(r){alert(r.message||"Delete failed")}};return i.useEffect(()=>{l()},[]),x?e.jsx("div",{children:"Loading..."}):a?e.jsx("div",{className:"error",children:a}):e.jsxs("div",{className:"page-container",children:[e.jsxs("div",{className:"page-header",children:[e.jsx("h2",{children:"Products"}),e.jsxs("div",{className:"actions",children:[e.jsx("button",{className:"btn secondary",onClick:()=>window.location.href="/admin/dashboard",children:"â† Back"}),e.jsx("button",{className:"btn",onClick:()=>window.location.href="/admin/products/new",children:"+ Add New Product"}),e.jsx("button",{className:"btn",onClick:()=>window.location.href="/admin/clinical-products/new",children:"+ Add Clinical Product"}),e.jsx("button",{className:"btn",onClick:()=>window.location.href="/admin/machines/new",children:"+ Add Machine"})]})]}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Image"}),e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Price"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:j.map((t,r)=>{var u;const s=(t==null?void 0:t._id)||(t==null?void 0:t.id),n=(t==null?void 0:t.img)||Array.isArray(t==null?void 0:t.imageURLs)&&((u=t.imageURLs[0])==null?void 0:u.img)||"",h=(t==null?void 0:t.title)||(t==null?void 0:t.name)||"(no title)";return e.jsxs("tr",{children:[e.jsx("td",{children:n?e.jsx("img",{className:"brand-thumb",src:n,alt:h,onError:g=>{g.currentTarget.style.visibility="hidden"}}):e.jsx("div",{className:"brand-thumb",style:{visibility:"hidden"}})}),e.jsx("td",{children:h}),e.jsx("td",{children:typeof(t==null?void 0:t.price)=="number"?t.price.toFixed(2):(t==null?void 0:t.price)||"-"}),e.jsx("td",{children:e.jsxs("div",{className:"actions",children:[e.jsx("button",{className:"btn",disabled:!s,onClick:()=>window.location.href=s?`/admin/products/${s}`:"/admin/products",children:"Edit"}),e.jsx("button",{className:"btn danger",disabled:!s,onClick:()=>w(s),children:"Delete"})]})})]},s||r)})})]})]})};export{y as default};
