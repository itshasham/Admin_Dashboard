import{r as i,j as t,A as x}from"./index-CPlrO2ek.js";/* empty css                */const b=r=>Array.isArray(r)?r:!r||typeof r!="object"?[]:Array.isArray(r.data)?r.data:Array.isArray(r.items)?r.items:Array.isArray(r.machines)?r.machines:[],w=()=>{const[r,l]=i.useState([]),[d,c]=i.useState(!1),[n,o]=i.useState(""),u=()=>{try{const s=localStorage.getItem("adminToken");return s?{Authorization:`Bearer ${s}`}:{}}catch{return{}}},h=async()=>{c(!0),o("");try{const s=new URL(`${x}/machines`);s.searchParams.set("page","1"),s.searchParams.set("limit","200");const a=await fetch(s.toString(),{cache:"no-store"}),e=await a.json().catch(()=>null);if(!a.ok)throw new Error((e==null?void 0:e.message)||"Failed to load machines");l(b(e))}catch(s){l([]),o(s.message||"Failed to load machines")}finally{c(!1)}};i.useEffect(()=>{h()},[]);const f=async s=>{if(s&&window.confirm("Delete this machine?"))try{const a=await fetch(`${x}/machines/${s}`,{method:"DELETE",headers:{...u()}}),e=await a.json().catch(()=>({}));if(!a.ok)throw new Error((e==null?void 0:e.message)||"Delete failed");await h()}catch(a){alert(a.message||"Delete failed")}};return t.jsxs("div",{className:"page-container",children:[t.jsxs("div",{className:"page-header",children:[t.jsxs("div",{children:[t.jsx("h2",{children:"Machines"}),t.jsx("p",{className:"muted",children:"Machine catalog for customer view and inquiry via email/WhatsApp."})]}),t.jsxs("div",{className:"actions",children:[t.jsx("button",{className:"btn secondary",onClick:()=>window.location.href="/admin/dashboard",children:"â† Back"}),t.jsx("button",{className:"btn",onClick:()=>window.location.href="/admin/machines/new",children:"+ Add Machine"}),t.jsx("button",{className:"btn secondary",onClick:()=>window.location.href="/admin/clinical-products",children:"View Clinical Products"})]})]}),d&&t.jsx("div",{children:"Loading..."}),n&&t.jsx("div",{className:"error",children:n}),!d&&!n&&t.jsxs("table",{className:"table",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Image"}),t.jsx("th",{children:"Name"}),t.jsx("th",{children:"Model"}),t.jsx("th",{children:"Availability"}),t.jsx("th",{children:"Contact"}),t.jsx("th",{children:"Actions"})]})}),t.jsxs("tbody",{children:[r.map((s,a)=>{const e=(s==null?void 0:s._id)||(s==null?void 0:s.id),j=Array.isArray(s==null?void 0:s.images)?s.images[0]:"";return t.jsxs("tr",{children:[t.jsx("td",{children:j?t.jsx("img",{className:"brand-thumb",src:j,alt:(s==null?void 0:s.name)||"machine"}):t.jsx("div",{className:"brand-thumb",style:{visibility:"hidden"}})}),t.jsx("td",{children:(s==null?void 0:s.name)||"-"}),t.jsx("td",{children:(s==null?void 0:s.modelNumber)||"-"}),t.jsx("td",{children:(s==null?void 0:s.availability)||"-"}),t.jsx("td",{children:t.jsxs("div",{style:{display:"grid",gap:3},children:[t.jsx("small",{children:(s==null?void 0:s.contactEmail)||"No email"}),t.jsx("small",{children:(s==null?void 0:s.whatsappNumber)||"No WhatsApp"})]})}),t.jsx("td",{children:t.jsxs("div",{className:"actions",children:[t.jsx("button",{className:"btn",disabled:!e,onClick:()=>window.location.href=`/admin/machines/${e}`,children:"Edit"}),t.jsx("button",{className:"btn danger",disabled:!e,onClick:()=>f(e),children:"Delete"})]})})]},e||a)}),!r.length&&t.jsx("tr",{children:t.jsx("td",{colSpan:6,className:"muted",children:"No machines found."})})]})]})]})};export{w as default};
